import{r as l,j as e,S as R}from"./index-DVIZrL47.js";import{E as S}from"./ErrorMessage-OEIhc3ax.js";import{u as T}from"./MarvelService-C0bkEwwY.js";import{E as b}from"./ErrorBoundary-gdrwmpYX.js";function V(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const w="/assets/placeholder-CD64woru.png",A="/assets/mjolnir-g182l4Wh.png",U=s=>{const[t,c]=l.useState({}),{loading:r,error:n,getCharacter:a,clearError:o}=T();l.useEffect(()=>{u()},[]);const d=i=>{c(i)},u=()=>{o();const i=Math.floor(Math.random()*20+1);a(i).then(d)},g=n?e.jsx(S,{}):null,p=r?e.jsx(R,{}):null,j=r||n||!t?null:e.jsx(Y,{char:t});return e.jsxs("div",{className:"randomchar",children:[g,p,j,e.jsxs("div",{className:"randomchar__static",children:[e.jsxs("p",{className:"randomchar__title",children:["Random character for today!",e.jsx("br",{}),"Do you want to get to know him better?"]}),e.jsx("p",{className:"randomchar__title",children:"Or choose another one"}),e.jsx("button",{className:"button button__main",onClick:u,children:e.jsx("div",{className:"inner",children:"try it"})}),e.jsx("img",{src:A,alt:"mjolnir",className:"randomchar__decoration"})]})]})},Y=({char:s})=>{const{name:t,description:c,thumbnail:r,homepage:n,wiki:a}=s;return e.jsxs("div",{className:"randomchar__block",children:[e.jsx("img",{src:r,alt:"Random character",className:"randomchar__img",onError:o=>{o.target.onerror=null,o.target.src=w}}),e.jsxs("div",{className:"randomchar__info",children:[e.jsx("p",{className:"randomchar__name",children:t}),e.jsx("p",{className:"randomchar__descr",children:c}),e.jsxs("div",{className:"randomchar__btns",children:[e.jsx("a",{href:n,className:"button button__main",children:e.jsx("div",{className:"inner",children:"homepage"})}),e.jsx("a",{href:a,className:"button button__secondary",children:e.jsx("div",{className:"inner",children:"Wiki"})})]})]})]})};var C={exports:{}},k,I;function G(){if(I)return k;I=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return k=s,k}var E,L;function K(){if(L)return E;L=1;var s=G();function t(){}function c(){}return c.resetWarningCache=t,E=function(){function r(o,d,u,g,p,j){if(j!==s){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}r.isRequired=r;function n(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:n,element:r,elementType:r,instanceOf:n,node:r,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:c,resetWarningCache:t};return a.PropTypes=a,a},E}var O;function $(){return O||(O=1,C.exports=K()()),C.exports}var z=$();const F=V(z),W=s=>{const[t,c]=l.useState([]),[r,n]=l.useState(!1),a=l.useRef(!1),o=l.useRef(!1),{loading:d,error:u,getAllCharacters:g}=T();l.useEffect(()=>(p(N.current,!0),window.addEventListener("scroll",P),()=>{window.removeEventListener("scroll",P)}),[]);const p=(m,_)=>{r||a.current||(_||(a.current=!0),g(m).then(j).finally(()=>{a.current=!1}))},j=m=>{c(_=>{const f=new Set(_.map(y=>y.id)),v=m.filter(y=>!f.has(y.id)),h=[..._,...v];return N.current=h.length,m.length<6&&(n(!0),o.current=!0),h})},i=l.useRef([]),x=m=>{i.current.forEach(_=>_.classList.remove("char__item_selected")),i.current[m].classList.add("char__item_selected"),i.current[m].focus()},N=l.useRef(0),P=()=>{if(a.current||o.current)return;window.innerHeight+window.scrollY>=document.body.offsetHeight-50&&p(N.current,!1)};function D(m){const _=m.map((f,v)=>e.jsxs("li",{className:"char__item",tabIndex:0,ref:h=>i.current[v]=h,onClick:()=>{s.onCharSelected(f.id),x(v)},onKeyDown:h=>{(h.key===" "||h.key==="Enter")&&(h.preventDefault(),s.onCharSelected(f.id),x(v))},children:[e.jsx("img",{src:f.thumbnail,alt:f.name,onError:h=>{h.target.onerror=null,h.target.src=w}}),e.jsx("div",{className:"char__name",children:f.name})]},f.id));return e.jsx("ul",{className:"char__grid",children:_})}const M=D(t),B=u?e.jsx(S,{}):null,H=d&&!a.current?e.jsx(R,{}):null;return e.jsxs("div",{className:"char__list",children:[B,H,M,e.jsx("button",{className:"button button__main button__long",disabled:a.current,style:{display:r?"none":"block"},onClick:()=>{p(N.current,!1)},children:e.jsx("div",{className:"inner",children:"load more"})})]})};W.propTypes={onCharSelected:F.func.isRequired};const J=()=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"char__select",children:"Please select a character to see information"}),e.jsxs("div",{className:"skeleton",children:[e.jsxs("div",{className:"pulse skeleton__header",children:[e.jsx("div",{className:"pulse skeleton__circle"}),e.jsx("div",{className:"pulse skeleton__mini"})]}),e.jsx("div",{className:"pulse skeleton__block"}),e.jsx("div",{className:"pulse skeleton__block"}),e.jsx("div",{className:"pulse skeleton__block"})]})]}),q=s=>{const[t,c]=l.useState(null),{loading:r,error:n,getCharacter:a,clearError:o}=T();l.useEffect(()=>{d()},[s.charId]);const d=()=>{const{charId:x}=s;x&&(o(),a(x).then(u))},u=x=>{c(x)},g=t||r||n?null:e.jsx(J,{}),p=n?e.jsx(S,{}):null,j=r?e.jsx("div",{className:"char__spinner",children:e.jsx(R,{})}):null,i=r||n||!t?null:e.jsx(Q,{char:t});return e.jsxs("div",{className:"char__info",children:[g,p,j,i]})},Q=({char:s})=>{const{name:t,description:c,thumbnail:r,homepage:n,wiki:a,comics:o}=s;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"char__basics",children:[e.jsx("img",{src:r,alt:t,onError:d=>{d.target.onerror=null,d.target.src=w}}),e.jsxs("div",{children:[e.jsx("div",{className:"char__info-name",children:t}),e.jsxs("div",{className:"char__btns",children:[e.jsx("a",{href:n,className:"button button__main",children:e.jsx("div",{className:"inner",children:"homepage"})}),e.jsx("a",{href:a,className:"button button__secondary",children:e.jsx("div",{className:"inner",children:"Wiki"})})]})]})]}),e.jsx("div",{className:"char__descr",children:c}),e.jsx("div",{className:"char__comics",children:"Comics:"}),e.jsxs("ul",{className:"char__comics-list",children:[o.length>0?null:"There are no comics with this character",o.map((d,u)=>{if(!(u>9))return e.jsx("li",{className:"char__comics-item",children:d},u)})]})]})};q.propTypes={charId:F.number};const X="/assets/vision-DvadOGgD.png",ne=()=>{const[s,t]=l.useState(null),c=r=>{t(r)};return e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx(U,{})}),e.jsxs("div",{className:"char__content",children:[e.jsx(b,{children:e.jsx(W,{onCharSelected:c})}),e.jsx(b,{children:e.jsx(q,{charId:s})})]}),e.jsx("img",{className:"bg-decoration",src:X,alt:"vision"})]})};export{ne as default};
